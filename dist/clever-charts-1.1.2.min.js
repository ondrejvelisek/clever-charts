!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):t.CleverCharts=e(t.d3)}(this,function(d){"use strict";function t(t,e){void 0===e&&(e={});var i=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===i&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}!function(){function h(t){this.value=t}function t(a){var o,r;function s(t,e){try{var i=a[t](e),n=i.value;n instanceof h?Promise.resolve(n.value).then(function(t){s("next",t)},function(t){s("throw",t)}):l(i.done?"return":"normal",i.value)}catch(t){l("throw",t)}}function l(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?s(o.key,o.arg):r=null}this._invoke=function(n,a){return new Promise(function(t,e){var i={key:n,arg:a,resolve:t,reject:e,next:null};r?r=r.next=i:(o=r=i,s(n,a))})},"function"!=typeof a.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(t){return this._invoke("next",t)},t.prototype.throw=function(t){return this._invoke("throw",t)},t.prototype.return=function(t){return this._invoke("return",t)}}();var O=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),e=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},B=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},C=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];O(this,e),this._handlers=t.reduce(function(t,e){return t[e]=[],t},{})}return s(e,[{key:"on",value:function(t,e){if(!(t in this._handlers))throw"No such event: "+t;return this._handlers[t].push(e),this}},{key:"off",value:function(t,e){if(!(t in this._handlers))throw"No such event: "+t;if(e){var i=this._handlers[t],n=i.indexOf(e);-1!=n&&i.splice(n,1)}else this._handlers[t]=[];return this}},{key:"add",value:function(t){return t in this._handlers||(this._handlers[t]=[]),this}},{key:"fire",value:function(t){if(!(t in this._handlers))throw"No such event: "+t;for(var e=this._handlers[t],i=arguments.length,n=Array(1<i?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];for(var o=0;o<e.length;o++)e[o].apply(this,n);return this}},{key:"destroy",value:function(){return this._handlers=null,this}}]),e}(),n=10,a=10,o=0,r="#49ace2",l="#F0F0F0",h="transparent",u=250;t("._svg_1q59h_1 {\n    \n}\n\n._doughnut_1q59h_5 {\n    \n}\n\n._arc_1q59h_9 {\n    \n}",{});var c="_svg_1q59h_1",_="_doughnut_1q59h_5",f=2*Math.PI,v=function(){function e(t){O(this,e),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._rendered=!1,this._observable=new C(["mouseOver","mouseOut"])}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(t){var e=this,i=this._containerEl=d.select(t),n=this._containerEl.node().offsetWidth,a=this._containerEl.node().offsetHeight,o=this._value=this._options.value,r=this._angle=o/100*f,s=this._innerRadius=this._options.innerRadius,l=this._outerRadius=this._options.outerRadius,h=this._arc=d.arc().innerRadius(s).outerRadius(l).startAngle(0);this._svgEl=i.append("svg").attr("width",n).attr("height",a).attr("class",c);var u=this._groupEl=this._svgEl.append("g").attr("class",_).attr("transform","translate("+n/2+", "+a/2+")");return this._inactiveArc=u.append("path").datum({endAngle:f}).attr("fill",this._options.inactiveColor).attr("d",h),this._activeArc=u.append("path").datum({endAngle:r}).attr("fill",this._options.activeColor).attr("d",h),this._backgroundArc=u.append("circle").attr("fill",this._options.backgroundColor).attr("r",s).attr("cx",0).attr("cy",0),this._backgroundArc=u.append("circle").attr("fill",this._options.backgroundColor).attr("r",s).attr("cx",0).attr("cy",0),this._hoverEl=u.append("rect").attr("fill","transparent").attr("x",-n/2).attr("y",-a/2).attr("width",n).attr("height",a),u.on("mouseover",function(){e._observable.fire("mouseOver")}),u.on("mouseout",function(){e._observable.fire("mouseOut")}),this._rendered=!0,this}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"update",value:function(t){var e=this,i=t||{};void 0===i.value?i.value=this._value:this._value=i.value;var n=this._activeArc.transition().duration(this._options.animationDuration).attrTween("d",this._arcTween(i,!0));return this._inactiveArc.transition().duration(this._options.animationDuration).attrTween("d",function(){return function(){return e._arc({endAngle:f})}}),this._backgroundArc.transition().duration(this._options.animationDuration).attrTween("r",function(){return function(){return e._innerRadius}}),i.activeColor&&i.activeColor!==this._options.activeColor&&(this._options.activeColor=i.activeColor,n.attr("fill",i.activeColor)),this}},{key:"_arcTween",value:function(t){var n=this,a=t.value/100*f;void 0!==t.value&&(a=t.value/100*f);var e=this._innerRadius,i=this._outerRadius;void 0!==t.innerRadius&&(e=t.innerRadius),void 0!==t.outerRadius&&(i=t.outerRadius);var o=d.interpolate(this._outerRadius,i),r=d.interpolate(this._innerRadius,e);return function(e){var i=d.interpolate(e.endAngle,a);return function(t){return n._arc.outerRadius(n._outerRadius=o(t)),n._arc.innerRadius(n._innerRadius=r(t)),e.endAngle=n._angle=i(t),n._arc(e)}}}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this}}]),e}();function p(t,e){return void 0===t?e:t}var i=function(){function i(t){var e=this;O(this,i),this._options={},this._options.outerRadius=p(t.outerRadius,n),this._options.innerRadius=p(t.innerRadius,a),this._options.activeColor=p(t.activeColor,r),this._options.inactiveColor=p(t.inactiveColor,l),this._options.backgroundColor=p(t.backgroundColor,h),this._options.value=p(t.value,o),this._options.animationDuration=p(t.animationDuration,u),this._options.renderTo=p(t.renderTo,null),this._observable=new C(["mouseOver","mouseOut"]),this._doughnutRenderer=new v(this._options),this._doughnutRenderer.on("mouseOver",function(){e._observable.fire("mouseOver")}),this._doughnutRenderer.on("mouseOut",function(){e._observable.fire("mouseOut")}),t.renderTo&&this.render(t.renderTo)}return s(i,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._doughnutRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._doughnutRenderer.render(t),this}},{key:"update",value:function(t){if(!this._doughnutRenderer.isRendered())throw"Can't call update() when widget is not rendered, please call .render() first.";return this._doughnutRenderer.update(t),this}}]),i}(),g=360,b=150,m={top:0,left:5,right:5,bottom:15},y="#f0f0f0",k=1,x="#ffea00",S=1,w="#49ace2",E=!0,D=11,M=["#e6f3fb","#cbe7f6","#b1dbf2","#98cfee","#7ec4ea"],L=function(){function i(t,e){O(this,i),this._histogramData=this._loadHistogramData(t,e.width),this._minMax=this._calculateMinMax(this._histogramData),this._options=e}return s(i,[{key:"getMinMax",value:function(){return this._minMax}},{key:"getData",value:function(){return this._histogramData}},{key:"_calculateMinMax",value:function(t){return{min:d.min(t,function(t){return t.value}),max:d.max(t,function(t){return t.value})}}},{key:"getValueRatio",value:function(){return(this._minMax.max-this._minMax.min)/this._options.width}},{key:"positionToValue",value:function(t){var e=this.getMinMax();return 0===t?e.min:t===this._options.width?e.max:t*this.getValueRatio()+e.min}},{key:"valueToPosition",value:function(t){var e=this.getValueRatio(),i=this.getMinMax(),n=Math.min(Math.max(t,i.min),i.max);return Math.round(n/e-i.min/e)}},{key:"_loadHistogramData",value:function(a,t){var o=[],r=(t-1)/a.length;return a.forEach(function(t,e){var i=(t.max-t.min)/r,n=Array.isArray(t.volume)?t.volume:[t.volume];d.range(t.min,t.max,i).forEach(function(t){o.push({value:t,volume:n})}),e==a.length-1&&o.push({value:t.max,volume:n})}),o}}]),i}();t("._histogram_1m7go_1 text {\n    font-family: Roboto;\n}\n\n._bar_1m7go_5 {\n\n}\n\ng {\n    border:1px solid #eeeeee;\n}\n\ng ._selectionbar_1m7go_13 {\n    cursor:default;\n}\n\n._x-axis_1m7go_17>path {\n    stroke: #F1F1F1;\n}\n\n._x-axis_1m7go_17 {\n    border:0;\n}\n\ng > text {\n    user-select: none;\n}\n\n._x-axis_1m7go_17>._tick_1m7go_29>text {\n    fill:#7d7d7d;\n}\n\ng._active_1m7go_33 ._custom-handle-circle_1m7go_33 {\n    stroke:#4a4a4a;\n}\n\ng._inactive_1m7go_37:not(._dragging_1m7go_37) ._custom-handle-circle_1m7go_33 {\n    stroke:#bababa;\n    r:2.5;\n}\n\ng._inactive_1m7go_37._dragging_1m7go_37 ._custom-handle-circle_1m7go_33 {\n    stroke:#4a4a4a;\n}    \n\ng._brush-drag_1m7go_46 ._custom-handle-circle_1m7go_33 {\n    stroke:#4a4a4a;\n}    \n\n._custom-handle-circle_1m7go_33 {\n    transition: r 0.1s ease-out;\n    pointer-events: none;\n}\n\n._brush-axis-line_1m7go_55 {\n    stroke:#4a4a4a;\n    display: none;\n    stroke-width: 1px;\n}\n\n._custom-handle-line_1m7go_61 {\n    stroke-width:0;\n    fill:#4A4A4A;\n    pointer-events: none;\n}\n\n._handle_1m7go_67 {\n    transition: all 0.05s ease-out;\n}\n\n._brush_1m7go_46>._selection_1m7go_13 {\n    fill: rgba(0, 0, 0, 0);\n    stroke: transparent;\n    cursor: grab;\n    cursor: -webkit-grab;\n    cursor: -moz-grab;\n}\n\n._brush_1m7go_46>._overlay_1m7go_79._grabbing_1m7go_79,\n._brush_1m7go_46>._selection_1m7go_13._grabbing_1m7go_79 {\n    cursor: grabbing ;\n    cursor: -webkit-grabbing ;\n    cursor: -moz-grabbing ;\n}\n\n._custom-handle_1m7go_33 {\n\n}\n\n._drag-label_1m7go_90 {\n    fill:#4A4A4A;\n}",{});var R={histogram:"_histogram_1m7go_1",bar:"_bar_1m7go_5",selectionbar:"_selectionbar_1m7go_13","x-axis":"_x-axis_1m7go_17",tick:"_tick_1m7go_29",active:"_active_1m7go_33","custom-handle-circle":"_custom-handle-circle_1m7go_33",inactive:"_inactive_1m7go_37",dragging:"_dragging_1m7go_37","brush-drag":"_brush-drag_1m7go_46","brush-axis-line":"_brush-axis-line_1m7go_55","custom-handle-line":"_custom-handle-line_1m7go_61",handle:"_handle_1m7go_67",brush:"_brush_1m7go_46",selection:"_selection_1m7go_13",overlay:"_overlay_1m7go_79",grabbing:"_grabbing_1m7go_79","custom-handle":"_custom-handle_1m7go_33","drag-label":"_drag-label_1m7go_90"},T=0,H=function(){function o(t,e,i,n,a){O(this,o),this._observable=new C(["drag","startDrag","endDrag"]),this._handleEl=null,this._handleLineEl=null,this._handleCircleEl=null,this._handleMaskEl=null,this._handleMaskGradientEl=null,this._handleLabelEl=null,this._isOver=!1,this._groupEl=t,this._index=i,this._value=e,this._initialValue=new Number(e),this._position=n.valueToPosition(e),this._initialPosition=new Number(this._position),this._options=a,this._histogramData=n,this._labelSizeCache={},this._elements=[],this._renderHandle()}return s(o,[{key:"destroy",value:function(){this._elements.forEach(function(t){return t.remove()}),this._elements=[]}},{key:"_renderHandle",value:function(){this._elements=[this._createHandleElement(),this._createHandleLineElement(),this._createHandleCircleElement(),this._createDragMaskElement(),this._createMaskGradientElement(),this._createDragLabelElement()],this._handleHoverState(),this._handleDrag()}},{key:"hide",value:function(){this._elements.forEach(function(t){return t.attr("visibility","hidden")})}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"getXPosition",value:function(){return parseInt(this._handleEl.attr("x"))+2}},{key:"setHoverState",value:function(){this._handleLineEl.attr("fill-opacity",1),this._handleLabelEl.attr("fill-opacity",1),this._handleMaskEl.attr("display","block"),this._handleCircleEl.attr("stroke-width",3),this._updateLabelPosition(this._position)}},{key:"getLabelBox",value:function(){return this._handleLabelEl.node().getBBox()}},{key:"setLabelOffset",value:function(t){this._handleLabelEl.attr("transform","translate("+t+", 0)"),this._handleMaskEl.attr("transform","translate("+t+", 0)"),this._updateLabelPosition(this._position)}},{key:"setHandleXPosition",value:function(t){return this._handleCircleEl.attr("transform","translate("+t+", "+this._options.height+")"),this}},{key:"setLabelText",value:function(t){return this._handleLabelEl.text(t),this}},{key:"showLabel",value:function(){return this._handleLabelEl.attr("fill-opacity",1),this._handleMaskEl.attr("display","block"),this}},{key:"hideLabel",value:function(){return this._handleLabelEl.attr("fill-opacity",0),this._handleMaskEl.attr("display","none"),this}},{key:"setLabelPosition",value:function(t){return this.setLabelOffset(0),this._updateLabelPosition(t),this}},{key:"unsetHoverState",value:function(){this._handleLineEl.attr("fill-opacity",0),this._handleLabelEl.attr("fill-opacity",0),this._handleMaskEl.attr("display","none"),this._handleCircleEl.attr("stroke-width",1),this._handleLabelEl.attr("transform","translate(0, 0)"),this._handleMaskEl.attr("transform","translate(0, 0)")}},{key:"enable",value:function(){this._elements.forEach(function(t){return t.attr("pointer-events","all")})}},{key:"disable",value:function(){this._elements.forEach(function(t){return t.attr("pointer-events","none")})}},{key:"_handleHoverState",value:function(){var t=this;this._handleEl.on("mouseover",function(){t._isOver=!0,t.setHoverState()}),this._handleEl.on("mouseout",function(){t._isOver=!1,t.unsetHoverState()})}},{key:"_onStartDrag",value:function(){this._groupEl.classed(R.dragging,!0),this._observable.fire("startDrag",this)}},{key:"_onDrag",value:function(){var t=this._options.width,e=this._options.height,i=Math.round(Math.max(Math.min(d.event.x,t),0));this._handleEl.attr("x",i-2),this._handleLineEl.attr("x",i-2),this._handleCircleEl.attr("transform","translate("+i+","+e+")"),this._handleEl.attr("data-handle-value",this._histogramData.positionToValue(i)),this.setHoverState(),this._position=i,parseInt(this._position)!==parseInt(this._initialPosition)?this._value=this._histogramData.positionToValue(i):this._value=this._initialValue,this._handleLabelEl.text(this._getLabelText()),this._updateLabelPosition(i),this._observable.fire("drag")}},{key:"_getLabelText",value:function(){return this._options.format(this._value)}},{key:"_onEndDrag",value:function(){this._groupEl.classed(R.dragging,!1),this._isOver||this.unsetHoverState(),this._observable.fire("endDrag",this)}},{key:"_handleDrag",value:function(){this._handleEl.call(d.drag().on("drag",this._onDrag.bind(this)).on("start",this._onStartDrag.bind(this)).on("end",this._onEndDrag.bind(this)))}},{key:"_getComputedLabelTextLength",value:function(t){var e=t.innerHTML;return this._labelSizeCache[e]=this._labelSizeCache[e]||t.getComputedTextLength(),this._labelSizeCache[e]}},{key:"_updateLabelPosition",value:function(t){var e=this._handleLabelEl.node(),i=this._options.fontSize,n=this._getComputedLabelTextLength(e),a=n+2*i,o=t-n/2;o<0&&(o=0),o+n>this._options.width?(o=this._options.width-n,this._handleLabelEl.attr("x",this._options.width),this._handleLabelEl.attr("text-anchor","end")):(this._handleLabelEl.attr("x",o),this._handleLabelEl.attr("text-anchor","start")),this._handleMaskEl.attr("x",function(){return parseInt(o)-i}),this._handleMaskGradientEl.attr("x1",o-i),this._handleMaskGradientEl.attr("x2",o+a-i),this._handleMaskEl.attr("width",a),this._handleMaskEl.attr("height",this._options.fontSize)}},{key:"_createMaskGradientElement",value:function(){return this._handleMaskGradientEl=this._groupEl.append("linearGradient").attr("id","brush-mask-gradient-"+T++).attr("gradientUnits","userSpaceOnUse").attr("y1",0).attr("x1",50).attr("y2",0).attr("x2",0),this._handleMaskGradientEl.selectAll("stop").data([{offset:"0%",color:"rgba(255,255,255,0)"},{offset:"20%",color:"rgba(255,255,255,1)"},{offset:"80%",color:"rgba(255,255,255,1)"},{offset:"100%",color:"rgba(255,255,255,0)"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),this._handleMaskGradientEl}},{key:"_createHandleElement",value:function(){return this._handleEl=this._groupEl.append("rect").attr("class",R["custom-handle"]).attr("fill-opacity",0).attr("data-handle-index",this._index).attr("data-handle-value",this._value).attr("cursor","ew-resize").attr("width",4).attr("height",this._options.height+5).attr("x",this._position-2),this._handleEl}},{key:"_createHandleLineElement",value:function(){return this._handleLineEl=this._groupEl.append("rect").attr("class",R["custom-handle-line"]).attr("width",4).attr("height",this._options.height).attr("fill-opacity",0).attr("x",this._position-2),this._handleLineEl}},{key:"_createHandleCircleElement",value:function(){return this._handleCircleEl=this._groupEl.append("circle").attr("class",R["custom-handle-circle"]).attr("transform","translate("+this._position+","+this._options.height+")").attr("fill","#ffffff").attr("fill-opacity",1).attr("stroke","#000").attr("stroke-width",1).attr("cursor","ew-resize").attr("r",3.5),this._handleCircleEl}},{key:"_createDragMaskElement",value:function(){return this._handleMaskEl=this._groupEl.append("rect").attr("class",R["drag-label-mask"]).attr("fill","url(#brush-mask-gradient-"+T+")").attr("y",this._options.height+7).attr("display","none"),this._handleMaskEl}},{key:"_createDragLabelElement",value:function(){var t=this,e=this._options.format,i=this._options.height;return this._handleLabelEl=this._groupEl.append("text").attr("class",R["drag-label"]).attr("fill-opacity",0).attr("font-size",this._options.fontSize).text(function(){return e(t._initialValue)}).attr("y",i+this._options.fontSize+7),this._updateLabelPosition(this._position),this._handleLabelEl}}]),o}();function z(t,e,i,n){var a=t.getLabelBox(),o=e.getLabelBox(),r=o.x-(a.x+a.width)-i;if(r<0){var s=r/2,l=r/2;a.x+s<0&&(s=a.x,l*=2);var h=o.x+o.width-l;return n<h&&(l+=h-n,s*=2),[s,-l]}return[0,0]}var A=function(){function e(t){O(this,e),this._options=t,this._groupEl=null,this._histogramData=null,this._histogramSelection=null,this._overSelectionIndex=null,this._rendered=!1,this._handles=[],this._draggingHandle=!1,this._prevSelection=null,this._rendered=!1,this._animating=!1,this._observable=new C(["selectionOver","toggleSelection","selectionChanged","handleClick"])}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(t){return this._rendered=!0,this._groupEl=t,this}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"_clear",value:function(){this._destroyHandles(),this._selectionBars&&this._selectionBars.remove()}},{key:"_destroyHandles",value:function(){this._handles.forEach(function(t){return t.destroy()}),this._handles=[]}},{key:"_onHandleClick",value:function(o,t){var r=this;this._options.promptHandler&&this._options.promptHandler(t).then(function(t){var e=JSON.stringify(r._histogramSelection.getOutputSelection());t=parseFloat(t);var i=r._histogramData.getMinMax();t=Math.min(i.max,t),t=Math.max(i.min,t);var n=r._histogramSelection.getSelectionPoints();n[o]={value:t};var a=n.sort(function(t,e){return t.value-e.value}).map(function(t){return r._histogramData.valueToPosition(t.value)});r._updateSelectionPositions(a,n),r._updateSelection(),r._destroyHandles(),r._renderHandles(),JSON.stringify(r._options.selection)!=e&&r._observable.fire("selectionChanged",r._histogramSelection.getOutputSelection())}),this._observable.fire("handleClick",o,t)}},{key:"_toggleSelection",value:function(t){var e=this._options.selection[t];e.disabled=!e.disabled;var i=!e.disabled;this._updateSelection(),this._observable.fire("toggleSelection",t,i)}},{key:"_onClick",value:function(){var t=d.select(d.event.target),e=t.attr("data-selection-index"),i=t.attr("data-handle-index");null!=e&&this._histogramSelection.allowsToggle()?this._toggleSelection(e):null!=i&&this._onHandleClick(i,t.attr("data-handle-value"))}},{key:"_handleClick",value:function(){this._groupEl.on("click",this._onClick.bind(this))}},{key:"refresh",value:function(t,e,i){return this._animate=i&&i.animate,this._animate&&this._histogramSelection&&this._histogramSelection.getSelection().length==e.getSelection().length&&(this._prevSelection=this._histogramSelection.getSelection(),this._prevHistogramData=this._histogramSelection.getSelection()),this._animate&&this._histogramData&&(this._prevHistogramData=this._histogramData),this._histogramData=t,this._histogramSelection=e,this._clear(),this._renderSelection(),this._updateSelection(),this._handleHoverState(),this._handleClick(),this}},{key:"_updateSelectionControlsHoverState",value:function(t){var e=this._handles.slice().sort(function(t,e){return t.getXPosition()-e.getXPosition()});if(e.forEach(function(t){return t.unsetHoverState()}),null!=t){var i=e[t],n=e[t+1];i.setHoverState(),n.setHoverState();var a=z(i,n,this._options.fontSize,this._options.width);i.setLabelOffset(a[0]),n.setLabelOffset(a[1])}}},{key:"_onSelectionMouseOver",value:function(t,e,i){if(!this._draggingHandle){d.select(i[e]).attr("fill","rgba(0,0,0,0.00)");var n=parseInt(d.select(d.event.target).attr("data-selection-index"));this._overSelectionIndex!=n&&(this._overSelectionIndex=n,this._updateSelection(),this._updateSelectionControlsHoverState(n),this._observable.fire("selectionOver",this._overSelectionIndex))}}},{key:"_onSelectionMouseOut",value:function(t,e,i){this._draggingHandle||(d.select(i[e]).attr("fill","rgba(0,0,0,0)"),this._overSelectionIndex=null,this._updateSelectionControlsHoverState(null),this._updateSelection(),this._observable.fire("selectionOver",this._overSelectionIndex))}},{key:"_handleHoverState",value:function(){var t=this._groupEl;t.selectAll("."+R.selectionbar).on("mouseout",this._onSelectionMouseOut.bind(this)),t.selectAll("."+R.selectionbar).on("mouseover",this._onSelectionMouseOver.bind(this))}},{key:"_onHandleDrag",value:function(){var t=this._handles.map(function(t){return t.getXPosition()}).sort(function(t,e){return t-e});this._updateSelectionPositions(t),this._updateSelection()}},{key:"_updateSelectionPositions",value:function(a,o){var r=this,s=this._histogramSelection.getSelection();a.forEach(function(t,e){if(!(e>s.length-1)){var i={from:t,to:a[e+1]},n={from:o?o[e].value:r._histogramData.positionToValue(i.from),to:o?o[e+1].value:r._histogramData.positionToValue(i.to)};["from","to"].forEach(function(t){(o?s[e][t]!==n[t]:s[e].position[t]!==i[t])&&(s[e][t]=n[t],s[e].position[t]=i[t])})}})}},{key:"_renderSelection",value:function(){var t=this._options.height,e=this._histogramSelection.getSelection();this._selectionBars=this._groupEl.selectAll("."+R.selectionbar).data(e).enter().append("rect").attr("class",R.selectionbar).attr("y",0).attr("fill","rgba(0,0,0,0.00)").attr("height",t),this._renderHandles()}},{key:"_renderHandles",value:function(){var o=this;this._handles=this._histogramSelection.getSelectionPoints().map(function(t,e){var i,n=t.value,a=new H(o._groupEl,n,e,o._histogramData,o._options);return t.hidden&&a.hide(),a.on("drag",function(){o._onHandleDrag()},o),a.on("startDrag",function(){i=JSON.stringify(o._options.selection),o._draggingHandle=!0,o._handles.forEach(function(t){return t.disable()}),a.enable()},o),a.on("endDrag",function(){o._draggingHandle=!1,o._handles.forEach(function(t){return t.enable()}),JSON.stringify(o._options.selection)!=i&&o._observable.fire("selectionChanged",o._histogramSelection.getOutputSelection())},o),a})}},{key:"_getBarSelectionIndex",value:function(t,e,i){for(var n=0;n<e.length;n++){var a=e[n],o=n==e.length-1;if(t>=i.valueToPosition(a.from)&&(t<i.valueToPosition(a.to)||o&&t<=i.valueToPosition(a.to)))return n}return null}},{key:"_getSelectionColor",value:function(t,e){return t.colors?t.colors[e.volumeIndex]:t.color?t.color:this._options.selectionColor}},{key:"_getBarColor",value:function(t,e,i,n){var a=this._options.inactiveBarColor,o=this._options.overSelectionColor,r=this._getBarSelectionIndex(t,e,i);return null==r?a:e[r].disabled?a:this._histogramSelection.allowsToggle()&&this._overSelectionIndex==r?o:this._getSelectionColor(e[r],n)}},{key:"_getBarOpacity",value:function(t,e,i){var n=this._getBarSelectionIndex(t,e,i),a=this._histogramSelection.allowsToggle()&&this._overSelectionIndex==n,o=null!=n&&e[n].disabled;return a?this._options.overSelectionOpacity:o?this._options.inactiveBarOpacity:null!=n&&null!=e[n].opacity?e[n].opacity:1}},{key:"_onSelectionTransition",value:function(r,s,l,h,u,c){var d=this;r.forEach(function(t,n){var e=s[n],i=d._options.width;if(r[n]){var a,o=[];o.push([Math.round(l.valueToPosition(t.from)),Math.round(h.valueToPosition(e.from))]),o.push([Math.round(l.valueToPosition(t.to)),Math.round(h.valueToPosition(e.to))]),a=[Math.abs((o[0][0]-o[0][1])/i),Math.abs((o[1][0]-o[1][1])/i)],o.forEach(function(t,e){for(var i=0;t[0]!==t[1];)setTimeout(u.bind(d,t[0],n,e),i),i+=.5/a[e],t[0]=t[0]>t[1]?t[0]-1:t[0]+1;0<i&&setTimeout(function(t,e,i){u(t,e,i),c(t,e,i)}.bind(d,t[1],n,e),++i)})}})}},{key:"_updateSelection",value:function(){var a=this,n=this._histogramSelection.getSelection(),o=this._groupEl.selectAll("."+R.bar),t=function(i,n){o.attr("fill",function(t){var e=a._histogramData.valueToPosition(t.value);return a._getBarColor(e,i,n,t)}),o.attr("fill-opacity",function(t){var e=a._histogramData.valueToPosition(t.value);return a._getBarOpacity(e,i,n,t)})};if(this._animate&&this._prevSelection){var e=this._prevSelection,i=this._prevHistogramData;t(e,this._prevHistogramData),e.forEach(function(t,e){var i=a._prevHistogramData.valueToPosition(t.from),n=a._prevHistogramData.valueToPosition(t.to);a._handles[e].setHandleXPosition(i).setLabelPosition(i),a._handles[e+1].setHandleXPosition(n).setLabelPosition(n)}),this._animating=!0,this._onSelectionTransition(e,n,i,this._histogramData,function(e,t,i){d.select(o.nodes()[e]).attr("fill",function(t){return a._getBarColor(e,n,a._histogramData,t)}),[a._handles[t],a._handles[t+1]][i].setHandleXPosition(e).setLabelPosition(e)},function(){t(n,a._histogramData),a._animating=!1}),this._prevSelection=null,this._prevHistogramData=null}else t(n,this._histogramData);this._groupEl.selectAll("."+R.selectionbar).data(n).attr("data-selection-index",function(t,e){return e}).attr("x",function(t){return a._histogramData.valueToPosition(t.from)}).attr("width",function(t){return a._histogramData.valueToPosition(t.to)-a._histogramData.valueToPosition(t.from)})}},{key:"showSelectionLabels",value:function(){var o=this;if(this._animating)return this._handles.forEach(function(t){return t.showLabel()});this._histogramSelection.getSelection().forEach(function(t,e){var i=o._handles[e],n=o._handles[e+1],a=z(i,n,o._options.fontSize,o._options.width);i.setLabelOffset(a[0]),n.setLabelOffset(a[1])}),this._handles.forEach(function(t){return t.showLabel()})}},{key:"hideSelectionLabels",value:function(){this._handles.forEach(function(t){return t.hideLabel()})}},{key:"destroy",value:function(){return this._observable.destroy(),this._clear(),this}}]),e}(),P=function(){function e(t){var i=this;O(this,e),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._historyData=null,this._xAxis=d.scaleBand().range([0,t.width]),this._yAxis=d.scaleLinear().range([t.height,0]),this._rendered=!1,this._prevData=null,this._selectionRenderer=new A(t),this._labelsVisible=!1,this._observable=new C(["selectionOver","toggleSelection","selectionChanged","handleClick"]),this._selectionRenderer.on("selectionOver",function(t){i._observable.fire("selectionOver",t)}),this._selectionRenderer.on("toggleSelection",function(t,e){i._observable.fire("toggleSelection",t,e)}),this._selectionRenderer.on("selectionChanged",function(t){i._observable.fire("selectionChanged",t)}),this._selectionRenderer.on("handleClick",function(t,e){i._observable.fire("handleClick",t,e)})}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){var e=this._containerEl=d.select(t),i=this._options.width,n=this._options.height,a=m,o=this._svgEl=e.append("svg").attr("width",i+a.left+a.right).attr("height",n+a.top+this._options.fontSize+a.bottom).classed(R.histogram,!0),r=this._groupEl=this._svgEl.append("g").classed(R.inactive,!0).attr("transform","translate("+a.left+","+a.top+")");return o.on("mouseover.hover",function(){r.classed(R.active,!0),r.classed(R.inactive,!1)}),o.on("mouseout.hover",function(){r.classed(R.inactive,!0),r.classed(R.active,!1)}),this._selectionRenderer.render(r),this._rendered=!0,this}},{key:"_clear",value:function(){this._groupEl.node().innerHTML=""}},{key:"refresh",value:function(t,e,i){return this._animate=i&&i.animate,this._histogramData=t,this._clear(),this._xAxis.domain(t.getData().map(function(t){return t.value})),this._yAxis.domain([0,d.max(t.getData(),function(t){return Math.max.apply(Math,t.volume)})]),this._renderXAxis(),this._renderDataBars(),this._prevData=t.getData(),this._selectionRenderer.refresh(t,e,i),this._labelsVisible&&this.showSelectionLabels(),this}},{key:"showSelectionLabels",value:function(){this._selectionRenderer.showSelectionLabels(),this._groupEl.selectAll("."+R["x-axis"]).attr("display","none"),this._labelsVisible=!0}},{key:"hideSelectionLabels",value:function(){this._selectionRenderer.hideSelectionLabels(),this._groupEl.selectAll("."+R["x-axis"]).attr("display","block"),this._labelsVisible=!1}},{key:"_renderDataBars",value:function(){var n=this,t=this._histogramData.getData(),a=this._options.height,o=this._yAxis;t.forEach(function(i){i.volume.forEach(function(t,e){n._groupEl.append("rect").datum({value:i.value,volumeIndex:e}).attr("class",R.bar).attr("x",n._histogramData.valueToPosition(i.value)).attr("width","1").attr("y",Math.floor(o(i.volume[e]))).attr("height",Math.ceil(a-o(i.volume[e])))})})}},{key:"_renderXAxis",value:function(){var i=this,t=this._histogramData.getMinMax(),e=this._options.format,n=this._options.height+this._options.fontSize+7;this._groupEl.selectAll("."+R["x-axis"]).data([t.min,t.max]).enter().append("text").text(function(t){return e(t)}).attr("font-size",this._options.fontSize).attr("transform",function(t,e){return["translate(0,"+n+")","translate("+i._options.width+","+n+")"][e]}).attr("text-anchor",function(t,e){return["start","end"][e]}).classed(R["x-axis"],!0)}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this._selectionRenderer.destroy(),this}}]),e}(),F=function(){function i(e,t){O(this,i),this._selection=t.map(function(t){return Object.assign(t,{position:{from:e.valueToPosition(t.from),to:e.valueToPosition(t.to)}})})}return s(i,[{key:"getSelection",value:function(){return this._selection}},{key:"getOutputSelection",value:function(){throw"HistogramSelection.getOutputSelection() has to be implemented"}},{key:"getSelectionType",value:function(){throw"HistogramSelection.getSelectionType() has to be implemented"}},{key:"allowsToggle",value:function(){throw"HistogramSelection.allowsToogle() has to be implemented"}},{key:"getSelectionPoints",value:function(){throw"HistogramSelection.getSelection() has to be implemented"}}]),i}(),q={MULTI:"multi",FILTER:"filter",INVERTED_FILTER:"inverted-filter"},V=function(t){function i(t,e){return O(this,i),B(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e))}return e(i,F),s(i,[{key:"getSelectionType",value:function(){return q.MULTI}},{key:"getOutputSelection",value:function(){return this._selection}},{key:"allowsToggle",value:function(){return!0}},{key:"getSelectionPoints",value:function(){var i=[],n=this.getSelection();return n.forEach(function(t,e){i.push({value:t.from}),e==n.length-1&&i.push({value:t.to})}),i}}]),i}(),I=function(t){function r(t){O(this,r);var e=t.getMinMax(),i=M,n=e.min,a=(e.max-e.min)/i.length,o=i.map(function(t){var e=n,i=n+a;return n+=a,{from:e,to:i,color:t}});return B(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,o))}return e(r,V),r}(),j=function(t){function i(t,e){if(O(this,i),1!=e.length)throw"Filter selection doesn't allow more than one selection";return B(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,e))}return e(i,F),s(i,[{key:"getOutputSelection",value:function(){return this._selection}},{key:"getSelectionType",value:function(){return q.FILTER}},{key:"allowsToggle",value:function(){return!1}},{key:"getSelectionPoints",value:function(){var i=[],n=this.getSelection();return n.forEach(function(t,e){i.push({value:t.from}),e==n.length-1&&i.push({value:t.to})}),i}}]),i}(),G=function(t){function n(t,e){O(this,n);var i=B(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t,e));return i._selection=i._getInvertedSelection(t,e),i}return e(n,j),s(n,[{key:"_getInvertedSelection",value:function(t,e){var i=t.getMinMax();return[{from:i.min,to:e[0].from},{from:e[0].from,disabled:!0,to:e[0].to},{from:e[0].to,to:i.max}]}},{key:"getOutputSelection",value:function(){return[{from:this._selection[1].from,to:this._selection[1].to}]}},{key:"getSelectionType",value:function(){return q.INVERTED_FILTER}},{key:"getSelectionPoints",value:function(){var t=function t(e,i,n){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,i);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(n):void 0}(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"getSelectionPoints",this).call(this);return t[0].hidden=!0,t[t.length-1].hidden=!0,t}}]),n}(),N=function(){function e(t){O(this,e),this._options=t}return s(e,[{key:"getHistogramSelection",value:function(t,e){return t?this._options.selectionType==q.FILTER?new j(e,t):this._options.selectionType==q.INVERTED_FILTER?new G(e,t):new V(e,t):new I(e,this._options.selection)}}]),e}();function W(t,e){return void 0===t?e:t}var X=function(){function e(t){var i=this;O(this,e),this._options={},this._options.promptHandler=t.promptHandler||null,this._options.width=W(t.width,g),this._options.height=W(t.height,b),this._options.format=W(t.format,null),this._options.inactiveBarColor=W(t.inactiveBarColor,y),this._options.inactiveBarOpacity=W(t.inactiveBarOpacity,k),this._options.overSelectionColor=W(t.overSelectionColor,x),this._options.overSelectionOpacity=W(t.overSelectionOpacity,S),this._options.selectionColor=W(t.selectionColor,w),this._options.enableSelectionToggle=W(t.enableSelectionToggle,E),this._options.fontSize=W(t.fontSize,D),this._options.selectionType=W(t.selectionType,null),this._observable=new C(["selectionOver","toggleSelection","selectionChanged","handleClick"]),this._histogramRenderer=new P(this._options),this._histogramRenderer.on("selectionOver",function(t){i._observable.fire("selectionOver",t)}),this._histogramRenderer.on("toggleSelection",function(t,e){i._observable.fire("toggleSelection",t,e,d.event)}),this._histogramRenderer.on("selectionChanged",function(t){i._observable.fire("selectionChanged",t)}),this._histogramRenderer.on("handleClick",function(t,e){i._observable.fire("handleClick",t,e)}),this._selectionFactory=new N(this._options)}return s(e,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._histogramRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._histogramRenderer.render(t),this}},{key:"setData",value:function(t,e,i){if(!this._histogramRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";var n=this._histogramData=new L(t,this._options),a=this._histogramSelection=this._selectionFactory.getHistogramSelection(e,n);return this._options.selection=a.getSelection(),this._selection=e,this._options.format?"string"==typeof this._options.format&&(this._options.format=d.format(this._options.format)):this._options.format=function(t){return String(t)},this._histogramRenderer.refresh(n,a,i),this}},{key:"setSelectionType",value:function(t){return this._options.selectionType=t,this.setSelection(this._selection),this}},{key:"showSelectionLabels",value:function(){this._histogramRenderer.showSelectionLabels()}},{key:"hideSelectionLabels",value:function(){this._histogramRenderer.hideSelectionLabels()}},{key:"setSelection",value:function(t,e){if(!this._histogramRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";if(!this._histogramData)throw"Can't call setSelection() when no data is available.";var i=this._histogramSelection=this._selectionFactory.getHistogramSelection(t,this._histogramData);return this._options.selection=i.getSelection(),this._selection=t,this._histogramRenderer.refresh(this._histogramData,this._histogramSelection,e),this}}]),e}();X.SelectionTypes=q;var U=360,Z=200,J="#7ed321",K=[],Q=1,Y="#7ed321",$=[],tt=.1,et=3,it=6,nt=28,at="#f0f0f0",ot="#bababa",rt=function(){function e(t){O(this,e),this._series=t.slice(),this._minMax=this._calculateMinMax(this._series)}return s(e,[{key:"getMinMax",value:function(){return this._minMax}},{key:"getSeries",value:function(){return this._series}},{key:"getAllData",value:function(){return[].concat.apply([],this._series)}},{key:"getMergedData",value:function(){var i={};return this.getAllData().forEach(function(t){var e=i[t.label]||{label:t.label,values:[],tooltips:[]};e.values.push(t.value),e.tooltips.push(t.tooltip),i[t.label]=e}),Object.values(i)}},{key:"_calculateMinMax",value:function(t){var e=[].concat.apply([],t),i=d.min(e,function(t){return t.value}),n=d.max(e,function(t){return t.value});return e.length<=t.length&&(i=Math.min(i,0),n=Math.max(n,0)),{min:i,max:n}}},{key:"getPrecision",value:function(){var t=this._minMax.max.toString().split(".");return 1<t.length?t[1].length:0}}]),e}();t("._line_gepny_1 text {\n    font-size: 11px;\n    fill:#7d7d7d;\n    font-family: Roboto;\n}\n\n._line_gepny_1 {\n    \n}\n\n._area_gepny_11 {\n    \n}\n\n._tooltip-group_gepny_15 {\n    \n}\n\n._tooltip-hover-area_gepny_19 {\n    \n}\n\n._tooltip-line-circle_gepny_23 {\n    fill: white;\n}\n\n._tooltip-axis-circle_gepny_27 {\n    stroke:#bababa;\n    fill: white;\n}\n\n._tooltip-label-mask_gepny_32 {\n    \n}\n\n._tooltip-top-label_gepny_36 {\n    border-radius: 4px;\n    font-size: 11px;\n    fill:#7d7d7d;\n    pointer-events: none;\n    white-space: nowrap;\n    font-family: Roboto;    \n    background-color: #ffffff;\n    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);\n    padding:3px 10px;\n    line-height:17px;\n}\n\n._svg_gepny_49 {\n    overflow: visible;\n}",{});var st={line:"_line_gepny_1",area:"_area_gepny_11","tooltip-group":"_tooltip-group_gepny_15","tooltip-hover-area":"_tooltip-hover-area_gepny_19","tooltip-line-circle":"_tooltip-line-circle_gepny_23","tooltip-axis-circle":"_tooltip-axis-circle_gepny_27","tooltip-label-mask":"_tooltip-label-mask_gepny_32","tooltip-top-label":"_tooltip-top-label_gepny_36",svg:"_svg_gepny_49"},lt=0,ht=function(){function e(t){O(this,e),this._options=t,this._groupEl=null,this._lineData=null,this._xAxis=null,this._yAxis=null,this._rendered=!1,this._observable=new C(["pointOver"])}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){return this._groupEl=t,this._rendered=!0,this._groupEl.on("mouseout",this._onMouseOut.bind(this)),this}},{key:"_getTextAnchor",value:function(t,e,i){return t-e/2<0?"start":i<t+e/2?"end":"middle"}},{key:"_getTooltipHTML",value:function(a){var o=this;return a.tooltips.filter(function(t,e){return null!=a.values[e]}).map(function(t,e){var i=t||o._options.format(a.values[e]),n='\n\t\t\t\t<span style="display:inline-block;position:relative;top:-1px;margin-right:5px;width:6px;height:6px;border-radius:50%;background-color:'+(o._options.lineColors[e]||o._options.lineColor)+'"></span>\n\t\t\t';return 1<a.tooltips.length?n+i:i}).join("<br />")}},{key:"_onHoverAreaOver",value:function(i){var t=(this._tooltipGroup.attr("visibility"),0),e=this._xAxis,n=this._yAxis,a=this._options.width,o=e(i.label);this._tooltipGroup.transition().duration(t).attr("visibility","visible").attr("transform","translate("+o+", 0)");var r=this._tooltipBottomLabel.node().getBBox().width,s=this._getTextAnchor(o,r,a);this._tooltipBottomLabel.text(i.label).attr("text-anchor",s),this._tooltipBottomLabel.attr("transform",function(){return{start:"translate("+-o+", 0)",middle:"translate(0, 0)",end:"translate("+(a-o)+", 0)"}[s]});var l=50+r;this._tooltipBottomLabelMask.attr("width",l).attr("x",function(){return{start:-o-25,middle:-l/2,end:a-o-l+25}[s]}),this._handleMaskGradientEl.attr("x1",-l/2),this._handleMaskGradientEl.attr("x2",l/2);var h=this._getTooltipHTML(i);this._tooltipTopLabel.node().innerHTML=h;var u=this._getLabelLeft(o);i.values.some(function(t){return null!=t})?(this._tooltipTopLabel.style("left",u+"px").style("visibility","visible").style("top",n(Math.max.apply(Math,i.values))-50+"px"),this._tooltipLineCircle.transition().duration(t).style("visibility",function(t,e){return i.values[e]?"visible":"hidden"}).attr("cy",function(t,e){return i.values[e]?n(i.values[e]):0})):(this._tooltipTopLabel.style("visibility","hidden"),this._tooltipLineCircle.style("visibility","hidden"))}},{key:"_getLabelLeft",value:function(t){var e=this._tooltipTopLabel.node().offsetWidth,i=t-e/2;return i<0&&(i=0),i>this._options.width-e&&(i=this._options.width-e),i}},{key:"_onMouseOut",value:function(){this._groupEl.node().parentNode.contains(d.event.relatedTarget)||(this._hideTooltip(),this._tooltipLineCircle.style("visibility","hidden"))}},{key:"_hideTooltip",value:function(){this._tooltipGroup.attr("visibility","hidden"),this._tooltipTopLabel.style("visibility","hidden")}},{key:"_renderTooltip",value:function(){var e,i=this,t=this._lineData.getMergedData(),n=this._lineData.getSeries();e=t.length>n.length?this._options.width/(t.length-1):this._options.width,this._hoverAreas=this._groupEl.selectAll("."+st["tooltip-hover-area"]).data(t).enter().append("rect").attr("class",st["tooltip-hover-area"]).attr("width",e).attr("fill-opacity",0).attr("x",function(t){return i._xAxis(t.label)-e/2}).attr("height",this._options.height).on("mouseover",this._onHoverAreaOver.bind(this)),this._tooltipGroup=this._groupEl.append("g").attr("visibility","hidden").attr("class",st["tooltip-group"]),this._tooltipLineCircle=this._tooltipGroup.selectAll("."+st["tooltip-line-circle"]).data(n).enter().append("circle").attr("visibility","hidden").attr("class",st["tooltip-line-circle"]).attr("stroke-width",this._options.lineWidth).attr("stroke",function(t,e){return i._options.lineColors[e]||i._options.lineColor}).attr("stroke-opacity",this._options.lineOpacity).attr("r",2.5+this._options.lineWidth/2),this._tooltipAxisCircle=this._tooltipGroup.append("circle").attr("class",st["tooltip-axis-circle"]).attr("stroke-width",1).attr("cy",this._options.height-nt).attr("r",3),this._tooltipBottomLabelMask=this._tooltipGroup.append("rect").attr("fill","url(#"+this._handleMaskGradientEl.attr("id")+")").attr("class",st["tooltip-label-mask"]).attr("y",this._options.height-5-15).attr("height",20),this._tooltipBottomLabel=this._tooltipGroup.append("text").attr("class",st["tooltip-label"]).attr("y",this._options.height-5).attr("text-anchor","start").text(t[0].label),this._tooltipTopLabel=d.select(this._groupEl.node().parentNode.parentNode).insert("span",":first-child").attr("class",st["tooltip-top-label"]).style("position","absolute").style("visibility","hidden"),this._tooltipRendered=!0}},{key:"_createMaskGradientElement",value:function(){return this._handleMaskGradientEl=this._groupEl.append("linearGradient").attr("id",st["tooltip-label-mask"]+"-"+lt+++"-gradient").attr("gradientUnits","userSpaceOnUse").attr("y1","0").attr("x1","0").attr("y2","0").attr("x2","0"),this._handleMaskGradientEl.selectAll("stop").data([{offset:"0%",color:"rgba(255,255,255,0)"},{offset:"20%",color:"rgba(255,255,255,1)"},{offset:"80%",color:"rgba(255,255,255,1)"},{offset:"100%",color:"rgba(255,255,255,0)"}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),this._handleMaskGradientEl}},{key:"_clear",value:function(){this._tooltipRendered&&(this._hoverAreas.remove(),this._tooltipGroup.remove(),this._tooltipTopLabel.remove(),this._tooltipRendered=!1)}},{key:"update",value:function(t,e,i){return this._xAxis=e,this._yAxis=i,this._lineData=t,this._createMaskGradientElement(),this._clear(),this._renderTooltip(),this}},{key:"destroy",value:function(){return this._rendered&&this._clear(),this._observable.destroy(),this}}]),e}(),ut=function(){function e(t){O(this,e),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._lineData=null,this._xAxis=null,this._yAxis=null,this._rendered=!1,this._prevData=null,this._observable=new C(["pointOver"]),this._tooltipRenderer=new ht(t)}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){var e=this._containerEl=d.select(t),i=this._options.width,n=this._options.height;return e.style("position","relative"),this._svgEl=e.append("svg").attr("width",i).attr("height",n).classed(st.svg,!0).classed(st.line,!0),this._groupEl=this._svgEl.append("g"),this._tooltipRenderer.render(this._groupEl),this._rendered=!0,this}},{key:"_clear",value:function(){this._groupEl.node().innerHTML=""}},{key:"update",value:function(t){var i=this;this._lineData=t,this._clear();var e=this._options.width,n=this._options.height,a=this._options.verticalSpacing,o=t.getSeries(),r=t.getAllData(),s=t.getMinMax(),l=this._xAxis=d.scalePoint().range([0,e]),h=this._yAxis=d.scaleLinear().range([n-a,a]);return l.domain(r.map(function(t){return t.label})),h.domain([s.min,s.max]),this._renderZeroLine(r),o.forEach(function(t,e){i._renderDataLines(t,e)}),this._renderXAxis(r),this._tooltipRenderer.update(t,l,h),this}},{key:"_renderXAxis",value:function(t){this._groupEl.append("line").attr("x1",0).attr("x2",this._options.width).attr("y1",this._options.height-nt).attr("y2",this._options.height-nt).attr("stroke-width",1).attr("stroke",this._options.axisColor),1<t.length?(this._groupEl.append("text").text(t[0].label).attr("x",0).attr("y",this._options.height-5),this._groupEl.append("text").text(t[t.length-1].label).attr("x",this._options.width).attr("text-anchor","end").attr("y",this._options.height-5)):1==t.length&&this._groupEl.append("text").text(t[0].label).attr("x",this._options.width/2).attr("text-anchor","middle").attr("y",this._options.height-5)}},{key:"_showZeroLine",value:function(){return this._yAxis(0)<this._options.height-nt-10}},{key:"_renderZeroLine",value:function(){this._showZeroLine()&&this._groupEl.append("line").attr("x1",0).attr("x2",this._options.width).attr("y1",Math.round(this._yAxis(0))).attr("y2",Math.round(this._yAxis(0))).attr("stroke-dasharray","2 ,2").attr("stroke",this._options.zeroLineColor)}},{key:"_renderDataLines",value:function(t,e){var i=this,n=this._xAxis,a=this._yAxis,o=this._options,r=this._options.height-nt,s=this._showZeroLine()?Math.min(r,a(0)):r,l=o.lineColors[e]||o.lineColor,h=o.fillColors[e]||o.fillColor,u=d.area().x(function(t){return n(t.label)}).y0(s).y1(function(t){return a(t.value)}),c=d.line().x(function(t){return n(t.label)}).y(function(t){return a(t.value)});this._getGroupedData(t).forEach(function(t){1<t.length&&i._groupEl.append("path").data([t]).attr("class",st.area).attr("fill",h).attr("fill-opacity",o.fillOpacity).attr("d",u),t.length&&i._groupEl.append("path").data([t]).attr("fill","none").attr("stroke-linecap","round").attr("stroke",l).attr("stroke-opacity",1).attr("stroke-width",1<t.length?o.lineWidth:o.dotSize).attr("class",st.line).attr("d",function(t){var e=c(t);return e&&2==e.split(",").length?e+" "+e:e})})}},{key:"_getGroupedData",value:function(t){var e=[],i=[e];return t.forEach(function(t){null===t.value?(e=[],i.push(e)):e.push(t)}),i}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this}}]),e}();function ct(t,e){return void 0===t?e:t}var dt=function(){function i(t){var e=this;O(this,i),this._options={},this._options.width=ct(t.width,U),this._options.height=ct(t.height,Z),this._options.lineWidth=ct(t.lineWidth,et),this._options.dotSize=ct(t.dotSize,it),this._options.format=ct(t.format,null),this._options.lineColor=ct(t.lineColor,J),this._options.lineColors=ct(t.lineColors,K),this._options.lineOpacity=ct(t.lineOpacity,Q),this._options.fillColor=ct(t.fillColor,Y),this._options.fillColors=ct(t.fillColors,$),this._options.fillOpacity=ct(t.fillOpacity,tt),this._options.axisColor=ct(t.axisColor,at),this._options.zeroLineColor=ct(t.zeroLineColor,ot),this._options.verticalSpacing=ct(t.verticalSpacing,this._options.height/4),this._observable=new C(["pointOver"]),this._lineRenderer=new ut(this._options),this._lineRenderer.on("pointOver",function(t){e._observable.fire("pointOver",t)})}return s(i,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._lineRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._lineRenderer.render(t),this}},{key:"setSeries",value:function(t){return this.setData.apply(this,t)}},{key:"setData",value:function(){if(!this._lineRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=this._lineData=new rt(e,this._options);return this._options.format?"string"==typeof this._options.format&&(this._options.format=d.format(this._options.format)):this._options.format=d.format(",."+this._lineData.getPrecision()+"f"),this._lineRenderer.update(n),this}}]),i}(),_t=360,ft=43,vt="#f0f0f0",pt="#ffea00",gt="#49ace2",bt=[],mt=!1,yt=!1,kt=13,xt=11,St="sum",wt=function(){function i(t,e){O(this,i),this._options=e,this._series=t.slice(),this._minMax=this._calculateMinMax(this._series)}return s(i,[{key:"getMinMax",value:function(){return this._minMax}},{key:"getSeries",value:function(){return this._series}},{key:"getAllData",value:function(){return[].concat.apply([],this._series)}},{key:"getMergedData",value:function(){var i={};return this.getAllData().forEach(function(t){var e=i[t.label]||{label:t.label,values:[],disabled:t.disabled,highlighted:t.highlighted,colors:[],tooltips:[]};e.values.push(t.value),e.tooltips.push(t.tooltip),e.colors.push(t.color),i[t.label]=e}),Object.values(i)}},{key:"_calculateMinMax",value:function(t){var e=[].concat.apply([],t);if("sum"==this._options.minMax){var i=this._series.map(function(t){return d.sum(t,function(t){return t.value})});return{min:0,max:Math.max.apply(Math,i)}}var n=d.min(e,function(t){return t.value}),a=d.max(e,function(t){return t.value});return e.length<=t.length&&(n=Math.min(n,0),a=Math.max(a,0)),{min:n,max:a}}},{key:"getPrecision",value:function(){var t=this._minMax.max.toString().split(".");return 1<t.length?t[1].length:0}}]),i}();t("._bar_tcpf7_1 text {\n    font-family: Roboto;\n}\n\n._bar_tcpf7_1 {\n    \n}\n\n._bar-over_tcpf7_9>._bar-active_tcpf7_9 {\n    fill:#ffea00;\n}\n\n._bar-disabled_tcpf7_13>._bar-active_tcpf7_9 {\n    fill:#c9c9c9;\n}\n\n._bar-disabled_tcpf7_13>text{\n    fill:#cacaca;\n}\n\n._bar-disabled_tcpf7_13>circle{\n    fill:#cacaca;\n}\n\n._bar-active_tcpf7_9 {\n\n}\n\n._bar-inactive_tcpf7_29 {\n\n}\n\n._bar-label_tcpf7_33 {\n    font-weight: 700;\n}\n\n._bar-tooltip_tcpf7_37 {\n    \n}\n\n._bar-hover_tcpf7_41 {\n    \n}\n\ng text {\n    user-select: none;\n}",{});var Et="_bar_tcpf7_1",Ct="_bar-over_tcpf7_9",Dt="_bar-active_tcpf7_9",Mt="_bar-disabled_tcpf7_13",Lt="_bar-inactive_tcpf7_29",Rt="_bar-label_tcpf7_33",Tt="_bar-tooltip_tcpf7_37",Ht="_bar-hover_tcpf7_41",Ot=0,Bt=function(){function e(t){O(this,e),this._options=t,this._containerEl=null,this._groupEl=null,this._svgEl=null,this._barData=null,this._xAxis=null,this._yAxis=null,this._rendered=!1,this._observable=new C(["barOver","barOut","barClick","barDisabled"]),this._maskIndex=Ot++}return s(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"render",value:function(t){var e=this._containerEl=d.select(t),i=this._options.width,n=this._options.height;return this._svgEl=e.append("svg").attr("width",i).attr("class",Et).attr("height",n),this._groupEl=this._svgEl.append("g"),this._clipPath=this._svgEl.append("clipPath").attr("id","rounded-corners-"+this._maskIndex).append("rect").attr("y",this._options.labelFontSize+10).attr("rx",2.5).attr("ry",2.5).attr("width",this._options.width).attr("height",5),this._rendered=!0,this}},{key:"_clear",value:function(){this._groupEl.node().innerHTML=""}},{key:"setData",value:function(t){this._barData=t,this._clear();var e=t.getMergedData(),i=t.getMinMax(),n=this._options.barHeight,a=e.length*n;return this._xAxis=d.scaleLinear().range([0,this._options.width]),this._yAxis=d.scaleBand().range([a,0]),this._svgEl.attr("height",a),this._xAxis.domain([0,i.max]),this._yAxis.domain(e.map(function(t,e){return e}).reverse()),this._renderDataBars(e),this}},{key:"_renderDataBars",value:function(t){var s=this,l=this._xAxis,e=this._yAxis,n=this._observable,h=this._options;t.forEach(function(a,t){var o=s._groupEl.datum(a).append("g").attr("class",Et).attr("transform",function(){return"translate(0,"+Math.floor(e(t))+")"}).classed(Ct,function(t){return t.highlighted}).on("mouseover",function(t,e){h.enableBarHover&&(d.select(this).classed(Ct,!0),n.fire("barOver",e))}).on("mouseout",function(t,e){h.enableBarHover&&(d.select(this).classed(Ct,!1),n.fire("barOut",e))}).on("click",function(t,e){if(h.enableBarToggle){var i=!d.select(this).classed(Mt);d.select(this).classed(Mt,i),n.fire("barDisabled",e,i)}n.fire("barClick",e)}).classed(Mt,function(t){return t.disabled});o.append("text").text(function(t){return t.label}).attr("class",Rt).attr("x",10).attr("font-size",s._options.labelFontSize).attr("y",s._options.labelFontSize);var r=10;a.values.forEach(function(t,e){var i=o.append("text").text(function(){var t=a.values.length-1-e;return a.tooltips[t]||s._options.format(a.values[t])}).attr("class",Tt).attr("x",s._options.width-r).attr("text-anchor","end").attr("font-size",s._options.valueFontSize).attr("y",s._options.labelFontSize);r+=i.node().getComputedTextLength()+25,1<a.values.length&&o.append("circle").attr("r",3).attr("fill",function(){var t=a.values.length-1-e;return a.colors[t]||h.activeBarColors[t]||h.activeBarColor}).attr("cx",s._options.width-r-s._options.labelFontSize+30).attr("cy",s._options.labelFontSize/1.5);var n=6*e;o.append("rect").attr("transform","translate(0,"+n+")").attr("fill",function(){return a.colors[e]||h.activeBarColors[e]||h.activeBarColor}).attr("class",Dt).attr("x",0).attr("clip-path","url(#rounded-corners-"+s._maskIndex+")").attr("width",function(){return Math.floor(l(t))}).attr("y",s._options.labelFontSize+10).attr("height",5),o.append("rect").attr("transform","translate(0,"+n+")").attr("fill",vt).attr("class",Lt).attr("clip-path","url(#rounded-corners-"+s._maskIndex+")").attr("x",function(){return Math.floor(l(t))}).attr("width",function(){return s._options.width-Math.floor(l(t))}).attr("y",s._options.labelFontSize+10).attr("height",5)}),o.append("rect").attr("class",Ht).attr("fill","transparent").attr("x",0).attr("text-anchor","end").attr("cursor",function(){return s._options.enableBarHover?"pointer":"default"}).attr("y",0).attr("height",s._options.barHeight).attr("width",s._options.width)})}},{key:"destroy",value:function(){return this._rendered&&this._containerEl.node().removeChild(this._svgEl.node()),this._observable.destroy(),this}}]),e}();function zt(t,e){return void 0===t?e:t}var At=function(){function e(t){var i=this;O(this,e),this._options={},this._options.width=zt(t.width,_t),this._options.barHeight=zt(t.barHeight,ft),this._options.format=zt(t.format,null),this._options.labelFontSize=zt(t.labelFontSize,kt),this._options.valueFontSize=zt(t.valueFontSize,xt),this._options.inactiveBarColor=zt(t.inactiveBarColor,vt),this._options.overBarColor=zt(t.overBarColor,pt),this._options.activeBarColor=zt(t.activeBarColor,gt),this._options.activeBarColors=zt(t.activeBarColors,bt),this._options.enableBarToggle=zt(t.enableBarToggle,mt),this._options.enableBarHover=zt(t.enableBarHover,yt),this._options.minMax=zt(t.minMax,St),this._observable=new C(["barOver","barOut","barClick","barDisabled"]),this._barRenderer=new Bt(this._options),this._barRenderer.on("barOver",function(t){i._observable.fire("barOver",t)}),this._barRenderer.on("barOut",function(t){i._observable.fire("barOut",t)}),this._barRenderer.on("barClick",function(t){i._observable.fire("barClick",t)}),this._barRenderer.on("barDisabled",function(t,e){i._observable.fire("barDisabled",t,e)})}return s(e,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._barRenderer.destroy(),this._options=null,this}},{key:"render",value:function(t){return this._barRenderer.render(t),this}},{key:"setData",value:function(){if(!this._barRenderer.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];var n=this._barData=new wt(e,this._options);return this._options.format?"string"==typeof this._options.format&&(this._options.format=d.format(this._options.format)):this._options.format=d.format(",."+this._barData.getPrecision()+"f"),this._barRenderer.setData(n),this}}]),e}(),Pt=360,Ft=129,qt=13,Vt=11,It="",jt=["#49ace2","#CD21D3"],Gt=!1,Nt="sum",Wt=!1,Xt=!1,Ut=!1,Zt=",f",Jt=43,Kt=!1,Qt=5,Yt="#f0f0f0",$t=5,te=!0;t("\ng text {\n    user-select: none;\n}\n\n._barchart_gqiip_6 {\n    background-color: white;\n}\n\n._barchart_gqiip_6 text {\n    font-family: Roboto;\n}\n\n._barchart_gqiip_6 ._clickable-area_gqiip_14 {\n}\n\n\n._bar_gqiip_6 {\n}\n\n._bar_gqiip_6._bar-disabled_gqiip_21 text {\n    fill: #cacaca;\n}\n._bar_gqiip_6._bar-disabled_gqiip_21 ._stripe_gqiip_24 ._progress_gqiip_24 {\n    fill: #c9c9c9;\n}\n\n._bar_gqiip_6._hover-enabled_gqiip_28:hover ._stripe_gqiip_24 ._progress_gqiip_24,\n._bar_gqiip_6._bar-highlighted_gqiip_29 ._stripe_gqiip_24 ._progress_gqiip_24 {\n    fill: #ffea00;\n}\n\n\n._details_gqiip_34 text {\n    font-family: Roboto, sans-serif;\n}\n\n._details_gqiip_34._details-disabled_gqiip_38 text {\n    fill: #cacaca;\n}\n\n._details_gqiip_34 ._label_gqiip_42 {\n    font-weight: 700;\n}\n\n._details_gqiip_34 ._tooltip_gqiip_46 ._symbol_gqiip_46 {\n    font-weight: 900;\n}\n\n._details_gqiip_34 ._tooltip_gqiip_46 ._tooltip-text_gqiip_50 {\n}\n\n\n._stripe_gqiip_24 {\n}\n\n._stripe_gqiip_24 ._progress_gqiip_24 {\n}\n\n._stripe_gqiip_24 ._progress_gqiip_24 {\n}\n\n\n._hover_gqiip_28 {\n}\n\n._hover_gqiip_28 ._hover-left_gqiip_67 {\n}\n\n._hover_gqiip_28 ._hover-middle_gqiip_70 {\n}\n\n._hover_gqiip_28 ._hover-right_gqiip_73 {\n}\n\n",{});var ee={barchart:"_barchart_gqiip_6","clickable-area":"_clickable-area_gqiip_14",bar:"_bar_gqiip_6","bar-disabled":"_bar-disabled_gqiip_21",stripe:"_stripe_gqiip_24",progress:"_progress_gqiip_24","hover-enabled":"_hover-enabled_gqiip_28","bar-highlighted":"_bar-highlighted_gqiip_29",details:"_details_gqiip_34","details-disabled":"_details-disabled_gqiip_38",label:"_label_gqiip_42",tooltip:"_tooltip_gqiip_46",symbol:"_symbol_gqiip_46","tooltip-text":"_tooltip-text_gqiip_50",hover:"_hover_gqiip_28","hover-left":"_hover-left_gqiip_67","hover-middle":"_hover-middle_gqiip_70","hover-right":"_hover-right_gqiip_73"},ie=function(){function n(t,e,i){if(O(this,n),void 0===i)throw"barsData is required parameter";this._detailsData=e,this._barsData=i}return s(n,[{key:"getBar",value:function(t){return this._barsData[t]}},{key:"setBar",value:function(t,e){this._barsData[t]=e}},{key:"calculateMinMax",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"sum";if("sum"===a){var o=!1,r=!1,t=this.bars.reduce(function(t,e){var i=e.calculateMinMax(a).min,n=e.calculateMinMax(a).max;return i<0&&(o=!0),0<n&&(r=!0),t+Math.max(Math.abs(i),Math.abs(n))},0);return{min:o?-t:0,max:r?t:0}}return"auto"===a?{min:this.bars.reduce(function(t,e){return Math.min(t,e.calculateMinMax(a).min)},0),max:this.bars.reduce(function(t,e){return Math.max(t,e.calculateMinMax(a).max)},0)}:a}},{key:"getPrecision",value:function(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"max";return"max"===i?this.bars.reduce(function(t,e){return Math.max(t,e.getPrecision(i))},0):i}},{key:"details",get:function(){return this._detailsData},set:function(t){this._detailsData=t}},{key:"bars",get:function(){return this._barsData}}],[{key:"copyAs",value:function(t){return new n({},t.details,t.bars)}}]),n}(),ne=function(){function a(t,e){var i=t.label,n=t.disabled;if(O(this,a),void 0===i)throw"label is required parameter";this._label=i,this._disabled=n,this._tooltips=e}return s(a,[{key:"getTooltip",value:function(t){return this._tooltips[t]}},{key:"addTooltip",value:function(t){void 0===this._tooltips&&(this._tooltips=[]),this._tooltips.push(t)}},{key:"setTooltip",value:function(t,e){this._tooltips[t]=e}},{key:"getPrecision",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"max";return"max"===t?this.tooltips?this.tooltips.reduce(function(t,e){return Math.max(t,e.getPrecision())},0):0:t}},{key:"label",get:function(){return this._label},set:function(t){this._label=t}},{key:"tooltips",get:function(){return this._tooltips}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t}}],[{key:"copyAs",value:function(t){return new a({label:t.label,disabled:t.disabled},t.tooltips)}}]),a}(),ae=function(){function a(t){var e=t.text,i=t.symbol,n=t.color;if(O(this,a),void 0===e)throw"text is required parameter";this._symbol=i,this._color=n,this._text=e}return s(a,[{key:"getPrecision",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"max";if("max"===t){if(this.isNumber()){var e=this.text.toString();return e.includes(".")?e.split(".")[1].length:0}return 0}return t}},{key:"isNumber",value:function(){return!isNaN(parseFloat(this.text))&&isFinite(this.text)}},{key:"symbol",get:function(){return this._symbol},set:function(t){this._symbol=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"text",get:function(){return this._text},set:function(t){this._text=t}}],[{key:"copyAs",value:function(t){return new a({text:t.text,symbol:t.symbol,color:t.color})}}]),a}(),oe=function(){function o(t,e,i){var n=t.disabled,a=t.highlighted;if(O(this,o),void 0===i)throw"stripesData is required parameter";this._disabled=n,this._highlighted=a,this._detailsData=e,this._stripesData=i}return s(o,[{key:"getStripe",value:function(t){return this._stripesData[t]}},{key:"setStripe",value:function(t,e){this._stripesData[t]=e}},{key:"calculateMinMax",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"sum";if("sum"===a){var o=!1,r=!1,t=this.stripes.reduce(function(t,e){var i=e.calculateMinMax(a).min,n=e.calculateMinMax(a).max;return i<0&&(o=!0),0<n&&(r=!0),t+Math.max(Math.abs(i),Math.abs(n))},0);return{min:o?-t:0,max:r?t:0}}return"auto"===a?{min:this.stripes.reduce(function(t,e){return Math.min(t,e.calculateMinMax(a).min)},0),max:this.stripes.reduce(function(t,e){return Math.max(t,e.calculateMinMax(a).max)},0)}:a}},{key:"getPrecision",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"max";return void 0===this.details?0:null===this.details?0:this.details.getPrecision(t)}},{key:"disabled",get:function(){return this._disabled},set:function(t){this._disabled=t}},{key:"highlighted",get:function(){return this._highlighted},set:function(t){this._highlighted=t}},{key:"details",get:function(){return this._detailsData},set:function(t){this._detailsData=t}},{key:"stripes",get:function(){return this._stripesData}}],[{key:"copyAs",value:function(t){return new o({disabled:t.disabled,highlighted:t.highlighted},t.details,t.stripes)}}]),o}(),re=function(){function h(t){var e=t.value,i=t.color,n=t.right,a=(n=void 0===n?{}:n).value,o=n.color,r=t.left,s=(r=void 0===r?{}:r).value,l=r.color;if(O(this,h),void 0===e){if(void 0===a)throw"value or leftValue is required parameter";if(void 0===s)throw"value or rightValue is required parameter";this._right={value:a,color:o},this._left={value:s,color:l}}else this._value=e,this._color=i}return s(h,[{key:"calculateMinMax",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"sum";return this.dual?"sum"===t?{min:Math.min(0,this.left.value,this.right.value),max:Math.max(0,this.left.value+this.right.value)}:"auto"===t?{min:Math.min(0,this.left.value,this.right.value),max:Math.max(0,this.left.value,this.right.value)}:t:"sum"===t||"auto"===t?{min:Math.min(0,this.value),max:Math.max(0,this.value)}:t}},{key:"dual",get:function(){return void 0===this._value}},{key:"value",get:function(){return this._value},set:function(t){this._value=t}},{key:"color",get:function(){return this._color},set:function(t){this._color=t}},{key:"left",get:function(){return this._left},set:function(t){this._left=t}},{key:"right",get:function(){return this._right},set:function(t){this._right=t}}],[{key:"copyAs",value:function(t){return t.dual?new h({right:t.right,left:t.left}):new h({value:t.value,color:t.color})}}]),h}(),se=function(){function t(){O(this,t)}return s(t,[{key:"convert",value:function(t){var e=void 0;if(void 0!==t.details){var i=void 0;void 0!==t.details.tooltips&&(i=t.details.tooltips.map(function(t){return new ae(t)})),e=new ne(t.details,i)}var n=t.bars.map(function(t){var e=void 0;if(void 0!==t.details){var i=void 0;void 0!==t.details.tooltips&&(i=t.details.tooltips.map(function(t){return new ae(t)})),e=new ne(t.details,i)}var n=t.stripes.map(function(t){return new re(t)});return new oe(t,e,n)});return new ie(t,e,n)}}]),t}(),le=0,he=function(){function o(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"component",n=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=4<arguments.length&&void 0!==arguments[4]&&arguments[4];O(this,o),this._width=t,this._height=e,this._container=null,this._maskIndex=le++,this._className=i,this._observable=new C(["enter","leave","click"]),this._alignRight=n,this._alignBottom=a,this._data=null}return s(o,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"_renderContainer",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return d.select(t).append("g").attr("class",ee[this.className]).attr("transform","translate("+e+", "+i+")")}},{key:"render",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if(this.destroy(),this._container=this._renderContainer(t,e,n),this._container.datum(a),this._container.on("click",function(t){i._observable.fire("click",t)}).on("mouseenter",function(t){i._observable.fire("enter",t)}).on("mouseleave",function(t){i._observable.fire("leave",t)}),!this._container)throw"Component "+this._className+" was not rendered. Check your selector: "+t;var o=this._container.append("rect").attr("class",ee["clickable-area"]).attr("fill","transparent").attr("width",this.width).attr("height",this.height);return this.alignBottom&&o.attr("y",-this.height),this.alignRight&&o.attr("x",-this.width),this._render(a),this}},{key:"_render",value:function(t){}},{key:"destroy",value:function(){return this.isRendered()&&(this.clearData(),this._container.datum(null),this._container.remove(),this._container=null),this}},{key:"isRendered",value:function(){return null!==this._container}},{key:"setData",value:function(t){if(!this.isRendered())throw"Can't call setData() when component is not rendered, please call .render() first.";return"Object"===t.constructor.name&&(t=(new se).convert(t)),this.clearData(),this._data=t,this._setData(t),this}},{key:"clearData",value:function(){if(!this.isRendered())throw"Can't call clearData() when widget is not rendered, please call .render() first.";return this._clearData(),this._data=null,this}},{key:"_setData",value:function(t){}},{key:"_clearData",value:function(){}},{key:"width",get:function(){return this._width},set:function(t){this._width=t,this.isRendered()&&this._container.select("."+ee["clickable-area"]).attr("width",t),this.alignRight&&this._container.select("."+ee["clickable-area"]).attr("x",-t)}},{key:"height",get:function(){return this._height},set:function(t){this._height=t,this.isRendered()&&this._container.select("."+ee["clickable-area"]).attr("height",t),this.alignBottom&&this._container.select("."+ee["clickable-area"]).attr("y",-t)}},{key:"className",get:function(){return this._className}},{key:"container",get:function(){return this._container}},{key:"alignRight",get:function(){return this._alignRight}},{key:"alignBottom",get:function(){return this._alignBottom}},{key:"data",get:function(){return this._data}}]),o}(),ue=function(t){function v(t){var e=t.fontSize,i=void 0===e?Vt:e,n=t.width,a=void 0===n?i:n,o=t.height,r=void 0===o?i:o,s=t.symbol,l=t.activeColor,h=void 0===l?jt[0]:l,u=t.format,c=void 0===u?Zt:u,d=t.space,_=void 0===d?$t:d;O(this,v);var f=B(this,(v.__proto__||Object.getPrototypeOf(v)).call(this,a,r,"tooltip",!0,!0));return f._fontSize=i,f._symbol=s,f._activeColor=h,f._format=c,f._space=_,f._canvas,f}return e(v,he),s(v,[{key:"_render",value:function(){this.container.append("text").text("-").attr("class",ee["tooltip-text"]).attr("text-anchor","end").attr("font-size",this.fontSize),this._canvas=d.select("body").append("canvas").attr("class","text-width-helper").text("Helper element for computing text width")}},{key:"_setData",value:function(t){var e=this.format;if(!this.format.includes(".")){var i=d.formatSpecifier(this.format);i.precision=t.getPrecision("max"),e=i.toString()}var n=t.text;t.isNumber()&&(n=d.format(e)(t.text));var a=this.container.select("."+ee["tooltip-text"]).text(n),o=this._calculateTextWidth(a);if(t.symbol||this.symbol){var r=void 0;t.color instanceof Array?(this._renderTwoColoredFill(t.color[0],t.color[1]),r="url(#two-colored-symbol-"+this._maskIndex+")"):this.activeColor instanceof Array?(this._renderTwoColoredFill(this.activeColor[0],this.activeColor[1]),r="url(#two-colored-symbol-"+this._maskIndex+")"):r=t.color?t.color:this.activeColor;var s=this.container.append("text").text(t.symbol?t.symbol:this.symbol).attr("class",ee.symbol).attr("text-anchor","end").attr("font-size",this.fontSize).attr("fill",r).attr("x",-o-this.space);o+=this._calculateTextWidth(s)+this.space}this.width=o}},{key:"_calculateTextWidth",value:function(t){var e=this._canvas.node().getContext("2d"),i=window.getComputedStyle(t.node()),n=i.getPropertyValue("font-style"),a=i.getPropertyValue("font-variant"),o=i.getPropertyValue("font-weight"),r=i.getPropertyValue("font-strech"),s=i.getPropertyValue("font-size"),l=i.getPropertyValue("font-family");return e.font=n+" "+a+" "+o+" "+r+" "+s+" "+l,e.measureText(t.text()).width}},{key:"_renderTwoColoredFill",value:function(t,e){var i=this.container.append("pattern").attr("id","two-colored-symbol-"+this._maskIndex).attr("width","1").attr("height","1").attr("patternContentUnits","objectBoundingBox");i.append("rect").attr("fill",t).attr("width","1").attr("height","1"),i.append("path").attr("fill",e).attr("d","M0,0 L1,0 L1,1 Z")}},{key:"_clearData",value:function(){this.container.select("."+ee["tooltip-text"]).text("-"),this.container.select("."+ee.symbol).remove()}},{key:"fontSize",get:function(){return this._fontSize}},{key:"symbol",get:function(){return this._symbol}},{key:"activeColor",get:function(){return this._activeColor}},{key:"format",get:function(){return this._format}},{key:"space",get:function(){return this._space}}]),v}(),ce=function(t){function p(t){var e=t.width,i=void 0===e?Pt:e,n=t.height,a=void 0===n?r+10:n,o=t.labelFontSize,r=void 0===o?qt:o,s=t.tooltipFontSize,l=void 0===s?Vt:s,h=t.tooltipSymbol,u=void 0===h?It:h,c=t.activeColors,d=void 0===c?jt:c,_=t.format,f=void 0===_?Zt:_;O(this,p);var v=B(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,i,a,"details"));return v._labelFontSize=r,v._tooltipFontSize=l,v._tooltipSymbol=u,v._activeColors=d,v._format=f,v._tooltips,v}return e(p,he),s(p,[{key:"_render",value:function(){this.container.append("text").text("").attr("class",ee.label).attr("x",10).attr("y",this.labelFontSize).attr("font-size",this.labelFontSize)}},{key:"_setData",value:function(t){this._clearData(),this.container.select("."+ee.label).text(t.label),this.container.classed(ee["details-disabled"],t.disabled),t.tooltips&&(this._createTooltips(t),this._renderAndSetTooltipsData(t.tooltips))}},{key:"_createTooltips",value:function(t){var i=this,n=t.tooltips;n.slice().reverse();var a=this.format;if(!this.format.includes(".")){var e=d.formatSpecifier(this.format);e.precision=t.getPrecision("max"),a=e.toString()}this._tooltips=n.map(function(t,e){return new ue({fontSize:i.tooltipFontSize,symbol:1<n.length?i.tooltipSymbol:void 0,activeColor:i.activeColors[e%i.activeColors.length],format:a})})}},{key:"_renderAndSetTooltipsData",value:function(o){var r=this,s=this.width-10;this._tooltips.forEach(function(t,e){var i=r._tooltips.length-1-e,n=r._tooltips[i],a=o[i];n.render(r.container.node(),s,r.labelFontSize,i),n.setData(a),s-=n.width+24})}},{key:"_clearData",value:function(){this.container.select("."+ee.label).text("-"),this.container.selectAll("."+ee.tooltip).remove()}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors},set:function(t){this._activeColors=t}},{key:"format",get:function(){return this._format},set:function(t){this._format=t}},{key:"tooltips",get:function(){return this._tooltips}}]),p}(),de=0,_e=function(t){function y(t){var e=t.width,i=void 0===e?Pt:e,n=t.height,a=void 0===n?Qt:n,o=t.backgroundColor,r=void 0===o?Yt:o,s=t.activeColors,l=void 0===s?jt:s,h=t.dualValue,u=void 0===h?Wt:h,c=t.minMax,d=void 0===c?Nt:c,_=t.topCornerRounded,f=void 0===_?te:_,v=t.bottomCornerRounded,p=void 0===v?te:v,g=t.condensed,b=void 0===g?Gt:g;O(this,y);var m=B(this,(y.__proto__||Object.getPrototypeOf(y)).call(this,i,a,"stripe"));return m._backgroundColor=r,m._activeColors=l,m._dualValue=u,m._minMax=d,m._topCornerRounded=f,m._bottomCornerRounded=p,m._condensed=b,m}return e(y,he),s(y,[{key:"_render",value:function(){var t=this.container.append("clipPath").attr("id","rounded-corners-"+this._maskIndex);this.topCornerRounded&&this.bottomCornerRounded?t.append("rect").attr("width",this.width).attr("height",this.height).attr("rx",Math.min(this.width,this.height)/2).attr("ry",Math.min(this.width,this.height)/2):this.topCornerRounded||this.bottomCornerRounded?(t.append("rect").attr("width",this.width-2*this.height).attr("height",this.height).attr("x",this.height),this.topCornerRounded&&(t.append("circle").attr("cx",this.height).attr("cy",this.height).attr("r",this.height),t.append("circle").attr("cx",this.width-this.height).attr("cy",this.height).attr("r",this.height)),this.bottomCornerRounded&&(t.append("circle").attr("cx",this.height).attr("cy",0).attr("r",this.height),t.append("circle").attr("cx",this.width-this.height).attr("cy",0).attr("r",this.height))):t.append("rect").attr("width",this.width).attr("height",this.height),this._renderProgress(0,this.width,this.backgroundColor,"stripe-background")}},{key:"_setData",value:function(t){this.dualValue?(this._renderStripe(0,this.width/2-.5,t.left.value,t.left.color?t.left.color:this.activeColors[1]?this.activeColors[1]:this.activeColors[0],!0),this._renderStripe(this.width/2+.5,this.width,t.right.value,t.right.color?t.right.color:this.activeColors[0],!1)):this._renderStripe(0,this.width,t.value,t.color?t.color:this.activeColors[0])}},{key:"_clearData",value:function(){this.container.selectAll(ee.progress).remove()}},{key:"_renderXBase",value:function(t){this.container.append("line").attr("x1",t).attr("x2",t).attr("y1",0).attr("y2",this.condensed?-4:-7).attr("stroke","#C9C9C9").attr("stroke-width",1).attr("stroke-dasharray",[1,2]),this.container.append("line").attr("x1",t).attr("x2",t).attr("y1",this.height).attr("y2",this.height+(this.condensed?4:7)).attr("stroke","#C9C9C9").attr("stroke-width",1).attr("stroke-dasharray",[1,2])}},{key:"_renderStripe",value:function(t,e,i,n){var a=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o=d.scaleLinear().range([t,e]);a?o.domain([this.minMax.max,this.minMax.min]):o.domain([this.minMax.min,this.minMax.max]);var r=o(0);this.minMax.min<0&&0<this.minMax.max&&this._renderXBase(r),a===i<0?this._renderProgress(r,o(i),n):this._renderProgress(o(i),r,n)}},{key:"_renderProgress",value:function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"progress";i instanceof Array&&this._renderTwoColoredFill(i[0],i[1]),this.container.append("rect").attr("fill",i instanceof Array?"url(#two-colored-"+this._maskIndex+"-"+de+")":i).attr("class",ee[n]).attr("x",t).attr("y",0).attr("width",e-t).attr("height",this.height).attr("transform","translate(0, 0)").attr("clip-path","url(#rounded-corners-"+this._maskIndex+")")}},{key:"_renderTwoColoredFill",value:function(t,e){de++;var i=this.container.append("pattern").attr("id","two-colored-"+this._maskIndex+"-"+de).attr("width","20").attr("height","20").attr("patternUnits","userSpaceOnUse");i.append("rect").attr("fill",t).attr("width","20").attr("height","20"),i.append("path").attr("fill",e).attr("d","M20,0 L10,0 L20,10 Z"),i.append("path").attr("fill",e).attr("d","M0,0 L20,20 L10,20 L0,10 Z")}},{key:"dualValue",get:function(){return this._dualValue}},{key:"backgroundColor",get:function(){return this._backgroundColor}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"topCornerRounded",get:function(){return this._topCornerRounded}},{key:"bottomCornerRounded",get:function(){return this._bottomCornerRounded}},{key:"condensed",get:function(){return this._condensed}}]),y}(),fe=function(t){function r(t){var e=t.width,i=void 0===e?Pt:e,n=t.height,a=void 0===n?Jt:n;O(this,r);var o=B(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i,a,"hover"));return o._observable.add("leftEnter").add("leftLeave").add("rightEnter").add("rightLeave").add("middleEnter").add("middleLeave"),o}return e(r,he),s(r,[{key:"_render",value:function(){var t=this;this.container.append("rect").attr("class",ee["bar-left"]).attr("fill","transparent").attr("x",0).attr("y",0).attr("width",this.width/3).attr("height",this.height).on("mouseenter",function(){t._observable.fire("leftEnter",t.container.datum())}).on("mouseleave",function(){t._observable.fire("leftLeave",t.container.datum())}),this.container.append("rect").attr("class",ee["bar-middle"]).attr("fill","transparent").attr("x",this.width/3).attr("y",0).attr("width",this.width/3).attr("height",this.height).on("mouseenter",function(){t._observable.fire("middleEnter",t.container.datum())}).on("mouseleave",function(){t._observable.fire("middleLeave",t.container.datum())}),this.container.append("rect").attr("class",ee["bar-right"]).attr("fill","transparent").attr("x",this.width*(2/3)).attr("y",0).attr("width",this.width/3).attr("height",this.height).on("mouseenter",function(){t._observable.fire("rightEnter",t.container.datum())}).on("mouseleave",function(){t._observable.fire("rightLeave",t.container.datum())})}}]),r}(),ve=function(t){function H(t){var e=t.width,i=void 0===e?Pt:e,n=t.height,a=void 0===n?Jt:n,o=t.labelFontSize,r=void 0===o?qt:o,s=t.tooltipFontSize,l=void 0===s?Vt:s,h=t.tooltipSymbol,u=void 0===h?It:h,c=t.activeColors,d=void 0===c?jt:c,_=t.minMax,f=void 0===_?Nt:_,v=t.detailsHidden,p=void 0===v?Gt:v,g=t.detailsHeight,b=void 0===g?r+10:g,m=t.enableHover,y=void 0===m?Xt:m,k=t.enableToggle,x=void 0===k?Ut:k,S=t.dualValue,w=void 0===S?Wt:S,E=t.disabled,C=void 0===E?Kt:E,D=t.format,M=void 0===D?Zt:D,L=t.stripeBackgroundColor,R=void 0===L?Yt:L;O(this,H);var T=B(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,i,a,"bar"));return T._labelFontSize=r,T._tooltipFontSize=l,T._tooltipSymbol=u,T._activeColors=d,T._minMax=f,T._detailsHidden=p,T._detailsHeight=b,T._enableHover=y,T._enableToggle=x,T._dualValue=w,T._disabled=C,T._format=M,T._stripeBackgroundColor=R,T._details,T._stripes,T._observable.add("leftEnter").add("leftLeave").add("rightEnter").add("rightLeave").add("middleEnter").add("middleLeave").add("disabled"),T}return e(H,he),s(H,[{key:"_render",value:function(){this.detailsHidden||(this._createDetails(),this._renderDetails()),this.container.classed(ee["hover-enabled"],this.enableHover),this._createHover(),this.enableToggle&&this._doEnableToggle()}},{key:"_setData",value:function(t){this._disabled=t.disabled,this.container.classed(ee["bar-disabled"],this.disabled),this.container.classed(ee["bar-highlighted"],t.highlighted),this._setDetailsData(t.details),this._createStripes(t),this._renderStripes(),this._setStripesData(t),this._renderHover()}},{key:"_clearData",value:function(){this.detailsHidden||this._details.clearData()}},{key:"_createDetails",value:function(){this._details=new ce({width:this.width,height:this.detailsHeight,labelFontSize:this.labelFontSize,tooltipFontSize:this.tooltipFontSize,tooltipSymbol:this.tooltipSymbol,activeColors:this.activeColors,format:this.format})}},{key:"_renderDetails",value:function(){this._details.render(this.container.node(),0,0)}},{key:"_setDetailsData",value:function(t){if(this.details){var e=ne.copyAs(t);this.details.setData(e)}}},{key:"_createStripes",value:function(n){var a=this,o=n.calculateMinMax(this.minMax);this._stripes=n.stripes.map(function(t,e){var i=void 0;return i=1<n.stripes.length?[a.activeColors[e%a.activeColors.length]]:a.activeColors.slice(),new _e({width:a.width,activeColors:i,dualValue:a.dualValue,minMax:o,backgroundColor:a.stripeBackgroundColor,topCornerRounded:0===e,bottomCornerRounded:e===n.stripes.length-1,condensed:a.detailsHidden})})}},{key:"_renderStripes",value:function(){var i=this,n=this.detailsHidden?0:this.detailsHeight;this.stripes.forEach(function(t,e){t.render(i.container.node(),0,n+5*e,e)})}},{key:"_setStripesData",value:function(t){var i=this;t.stripes.forEach(function(t,e){return i.stripes[e].setData(t)})}},{key:"_createHover",value:function(){this._hover=new fe({width:this.width,height:this.height})}},{key:"_renderHover",value:function(){var e=this;this._hover.render(this.container.node(),0,0).on("leftEnter",function(t){e._observable.fire("leftEnter",t)}).on("leftLeave",function(t){e._observable.fire("leftLeave",t)}).on("rightEnter",function(t){e._observable.fire("rightEnter",t)}).on("rightLeave",function(t){e._observable.fire("rightLeave",t)}).on("middleEnter",function(t){e._observable.fire("middleEnter",t)}).on("middleLeave",function(t){e._observable.fire("middleLeave",t)})}},{key:"_doEnableToggle",value:function(){var e=this;this.container.attr("cursor","pointer"),this.on("click",function(t){e._disabled=!e._disabled,e.container.classed(ee["bar-disabled"],e.disabled),e._observable.fire("disabled",t,e._disabled)})}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"detailsHidden",get:function(){return this._detailsHidden}},{key:"detailsHeight",get:function(){return this._detailsHeight}},{key:"enableToggle",get:function(){return this._enableToggle}},{key:"enableHover",get:function(){return this._enableHover}},{key:"dualValue",get:function(){return this._dualValue}},{key:"disabled",get:function(){return this._disabled}},{key:"format",get:function(){return this._format}},{key:"stripeBackgroundColor",get:function(){return this._stripeBackgroundColor}},{key:"stripes",get:function(){return this._stripes}},{key:"details",get:function(){return this._details}}]),H}(),pe=function(t){function H(t){var e=t.width,i=void 0===e?Pt:e,n=t.height,a=void 0===n?Ft:n,o=t.labelFontSize,r=void 0===o?qt:o,s=t.tooltipFontSize,l=void 0===s?Vt:s,h=t.tooltipSymbol,u=void 0===h?It:h,c=t.activeColors,d=void 0===c?jt:c,_=t.minMax,f=void 0===_?Nt:_,v=t.detailsVisible,p=void 0===v?Gt:v,g=t.detailsHeight,b=void 0===g?r+10:g,m=t.dualValue,y=void 0===m?Wt:m,k=t.barHeight,x=void 0===k?Jt:k,S=t.enableBarHover,w=void 0===S?Xt:S,E=t.enableBarToggle,C=void 0===E?Ut:E,D=t.format,M=void 0===D?Zt:D,L=t.stripeBackgroundColor,R=void 0===L?Yt:L;O(this,H);var T=B(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,i,a,"barchart"));return T._labelFontSize=r,T._tooltipFontSize=l,T._tooltipSymbol=u,T._activeColors=d,T._minMax=f,T._detailsVisible=p,T._detailsHeight=b,T._dualValue=y,T._barHeight=x,T._enableBarHover=w,T._enableBarToggle=C,T._format=M,T._stripeBackgroundColor=R,T._details,T._bars,T._observable.add("barEnter").add("barLeave").add("barLeftEnter").add("barLeftLeave").add("barRightEnter").add("barRightLeave").add("barMiddleEnter").add("barMiddleLeave").add("barClick").add("barDisabled").add("barsEnter").add("barsLeave"),T}return e(H,he),s(H,[{key:"isBarDisabled",value:function(t){return this.bars[t].disabled}},{key:"updateData",value:function(t){this.setData(t(this.data))}},{key:"updateDetailsData",value:function(t){this.setDetailsData(t(this.details.data))}},{key:"updateBarData",value:function(t,e){this.setBarData(t,e(this.bars[t].data))}},{key:"setDetailsData",value:function(t){var e=ne.copyAs(t);this.details.setData(e)}},{key:"setBarData",value:function(t,e){var i=oe.copyAs(e);this._setDefaultBarDetails(e),this.bars[t].setData(i)}},{key:"_setDefaultBarDetails",value:function(n){var a=this;n.details||(n.details=new ne({label:this.data.details.label})),void 0===n.details.tooltips&&n.stripes.forEach(function(t,e){var i=void 0;i=1<n.stripes.length?[a.activeColors[e%a.activeColors.length]]:a.activeColors.slice(),a.dualValue?(n.details.addTooltip(new ae({text:t.left.value,symbol:a.tooltipSymbol,color:t.left.color?t.left.color:i[1]?i[1]:i[0]})),n.details.addTooltip(new ae({text:t.right.value,symbol:a.tooltipSymbol,color:t.right.color?t.right.color:i[0]}))):n.details.addTooltip(new ae({text:t.value,symbol:1<n.stripes.length?a.tooltipSymbol:void 0,color:t.color?t.color:i[0]}))})}},{key:"_renderContainer",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this._svgWrapper=d.select(t).append("svg").attr("class",ee[this.className]).attr("width",this.width).attr("height",this.height),this._svgWrapper.style({position:"relative",left:e,top:i}),this._svgWrapper.append("g")}},{key:"_render",value:function(){this.detailsVisible&&(this._createDetails(),this._renderDetails())}},{key:"_setData",value:function(t){var i=this;t.bars.forEach(function(t){return i._setDefaultBarDetails(t)}),this.detailsVisible&&(this._adjustDetails(t),this.setDetailsData(t.details)),this._adjustHeight(t),this._createBars(t),this._renderBars(),t.bars.forEach(function(t,e){return i.setBarData(e,t)})}},{key:"_clearData",value:function(){this.detailsVisible&&this._details.clearData(),this._container.selectAll("."+ee.bar).remove()}},{key:"_adjustDetails",value:function(t){if(!this.details.format.includes(".")){var e=d.formatSpecifier(this.format);e.precision=t.getPrecision("max"),this.details.format=e.toString()}this.dualValue&&t.details.tooltips&&1===t.bars[0].stripes.length&&(this.details.activeColors=this.details.activeColors.slice().reverse())}},{key:"_createDetails",value:function(){this._details=new ce({width:this.width,height:this.detailsHeight,labelFontSize:this.labelFontSize,tooltipFontSize:this.tooltipFontSize,tooltipSymbol:this.tooltipSymbol,activeColors:this.activeColors,format:this.format})}},{key:"_renderDetails",value:function(){this._details.render(this._container.node(),0,0)}},{key:"_createBars",value:function(t){var e=this,i=this.format;if(!this.format.includes(".")){var n=d.formatSpecifier(this.format);n.precision=t.getPrecision("max"),i=n.toString()}var a=t.calculateMinMax(this.minMax);this._bars=t.bars.map(function(){return new ve({width:e.width,height:e.barHeight,labelFontSize:e.labelFontSize,tooltipFontSize:e.tooltipFontSize,tooltipSymbol:e.tooltipSymbol,activeColors:e.activeColors,detailsHidden:e.detailsVisible,detailsHeight:e.detailsHeight,dualValue:e.dualValue,enableToggle:e.enableBarToggle,enableHover:e.enableBarHover,minMax:a,format:i,stripeBackgroundColor:e.stripeBackgroundColor})})}},{key:"_renderBars",value:function(){var n=this,a=this._container.append("g").on("mouseenter",function(){n._observable.fire("barsEnter")}).on("mouseleave",function(){n.detailsVisible&&n.enableBarHover&&n.details.setData(n.data.details),n._observable.fire("barsLeave")});this.bars.forEach(function(t,e){var i=n.detailsVisible?n.detailsHeight:0;t.render(a.node(),0,i+n.barHeight*e,e).on("click",function(t){n._observable.fire("barClick",t)}).on("enter",function(t){n.detailsVisible&&n.enableBarHover&&n.details.setData(n.bars[t].data.details),n._observable.fire("barEnter",t)}).on("leave",function(t){n._observable.fire("barLeave",t)}).on("leftEnter",function(t){n._observable.fire("barLeftEnter",t)}).on("leftLeave",function(t){n._observable.fire("barLeftLeave",t)}).on("rightEnter",function(t){n._observable.fire("barRightEnter",t)}).on("rightLeave",function(t){n._observable.fire("barRightLeave",t)}).on("middleEnter",function(t){n._observable.fire("barMiddleEnter",t)}).on("middleLeave",function(t){n._observable.fire("barMiddleLeave",t)}).on("disabled",function(t,e){if(n.detailsVisible&&n.enableBarHover){var i=n.details.data;i.disabled=e,n.details.setData(i)}n._observable.fire("barDisabled",t,e)})})}},{key:"_adjustHeight",value:function(t){var e=t.bars.length*this.barHeight;this.detailsVisible&&(e+=this.detailsHeight),this.height=e,this._svgWrapper.attr("height",e)}},{key:"labelFontSize",get:function(){return this._labelFontSize}},{key:"tooltipFontSize",get:function(){return this._tooltipFontSize}},{key:"tooltipSymbol",get:function(){return this._tooltipSymbol}},{key:"activeColors",get:function(){return this._activeColors}},{key:"minMax",get:function(){return this._minMax}},{key:"detailsVisible",get:function(){return this._detailsVisible}},{key:"detailsHeight",get:function(){return this._detailsHeight}},{key:"dualValue",get:function(){return this._dualValue}},{key:"barHeight",get:function(){return this._barHeight}},{key:"enableBarHover",get:function(){return this._enableBarHover}},{key:"enableBarToggle",get:function(){return this._enableBarToggle}},{key:"format",get:function(){return this._format}},{key:"stripeBackgroundColor",get:function(){return this._stripeBackgroundColor}},{key:"details",get:function(){return this._details}},{key:"bars",get:function(){return this._bars}}]),H}();return{Bar:function(){function E(t){var e=this,i=t.width,n=t.height,a=t.labelFontSize,o=t.valueFontSize,r=t.tooltipFontSize,s=void 0===r?o:r,l=t.tooltipSymbol,h=t.activeBarColor,u=t.activeBarColors,c=void 0===u?h?[h]:void 0:u,d=t.activeColors,_=void 0===d?c:d,f=t.inactiveBarColor,v=t.stripeBackgroundColor,p=void 0===v?f:v,g=t.minMax,b=t.detailsVisible,m=t.detailsHeight,y=t.dualValue,k=t.barHeight,x=t.enableBarHover,S=t.enableBarToggle,w=t.format;O(this,E),this._observable=new C([]),this._observable.add("barEnter").add("barLeave").add("barLeftEnter").add("barLeftLeave").add("barRightEnter").add("barRightLeave").add("barMiddleEnter").add("barMiddleLeave").add("barClick").add("barDisabled"),this._observable.add("barOver").add("barOut"),this._barchart=new pe({width:i,height:n,labelFontSize:a,tooltipFontSize:s,tooltipSymbol:l,activeColors:_,stripeBackgroundColor:p,minMax:g,detailsVisible:b,detailsHeight:m,dualValue:y,barHeight:k,enableBarHover:x,enableBarToggle:S,format:w}),this._barchart.on("barEnter",function(t){e._observable.fire("barEnter",t),e._observable.fire("barOver",t)}),this._barchart.on("barLeave",function(t){e._observable.fire("barLeave",t),e._observable.fire("barOut",t)}),this._barchart.on("barLeftEnter",function(t){e._observable.fire("barLeftEnter",t)}),this._barchart.on("barLeftLeave",function(t){e._observable.fire("barLeftLeave",t)}),this._barchart.on("barMiddleEnter",function(t){e._observable.fire("barMiddleEnter",t)}),this._barchart.on("barMiddleLeave",function(t){e._observable.fire("barMiddleLeave",t)}),this._barchart.on("barRightEnter",function(t){e._observable.fire("barRightEnter",t)}),this._barchart.on("barRightLeave",function(t){e._observable.fire("barRightLeave",t)}),this._barchart.on("barClick",function(t){e._observable.fire("barClick",t)}),this._barchart.on("barDisabled",function(t){e._observable.fire("barDisabled",t)})}return s(E,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._barchart.destroy(),this}},{key:"render",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return this._barchart.render(t,e,i),this}},{key:"setData",value:function(){if(!this._barchart.isRendered())throw"Can't call setData() when widget is not rendered, please call .render() first.";for(var e={},t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];i.forEach(function(t){t.forEach(function(t){void 0===e[t.label]&&(e[t.label]={},e[t.label].values=[]),e[t.label].label=t.label,e[t.label].disabled=e[t.label].disabled||t.disabled,e[t.label].highlighted=e[t.label].highlighted||t.highlighted,e[t.label].values.push({value:t.value,color:t.color,tooltip:t.tooltip})})});var a=[];for(var o in e){var r=e[o],s=[],l=void 0;for(var h in r.values){var u=r.values[h];s.push(new re({value:u.value,color:u.color})),void 0!==u.tooltip&&(void 0===l&&(l=[]),l.push(new ae({text:u.tooltip,color:u.color})))}a.push(new oe({disabled:r.disabled,highlighted:r.highlighted},new ne({label:o},l),s))}return this._barchart.setData(new ie({},null,a)),this}}]),E}(),Barchart:pe,BarLegacy:At,Doughnut:i,Histogram:X,Line:dt}});
//# sourceMappingURL=clever-charts-1.1.2.min.js.map
